---
title: "coactivity: Active and Co-active Subspaces in R"
output: github_document
bibliography: README-bib.bib
---

[![License: GPL v3](https://img.shields.io/badge/License-BSD_3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0)
`r badger::badge_devel("knrumsey/concordance", "purple")`



<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
library(BASS)
```

```{r, eval=TRUE, echo=FALSE, fig.cap="<span style='font-size:50%;'>This logo was designed by Imagine AI Art Studio.</span>", out.width='50%'}
knitr::include_graphics("inst/logos/Coactivity.png")
```


### Description 

`coactivity` is an R package for performing concordance analyses and for the [discovery of active subspaces in high-dimensions](https://arxiv.org/pdf/2307.11241.pdf) (described in @rumsey2024discovering). The "workhorse" of the package is the `C_bass()` function, which estimates *Constantine's* $C$ matrix (see @constantine2015active) for a given computer model and behaves similarly to the `activegp::C_gp()` function (described in @wycoff2021sequential). The `C_bass()` function, which relies on a Bayesian MARS emulator (as described in @francom2020bass and implemented in the [BASS package](https://CRAN.R-project.org/package=BASS)) is likely to be more efficient and accurate when the dimension of the input space is large and admits a large class of *measures* for the inputs. 

The package can also be used to estimate *co-active subspaces*, as described in @rumsey2024co. 

To install this package, use

```{R, eval=F}
# install.packages("devtools")
devtools::install_github("knrumsey/coactivity")
```


This R package is based on the method described [here](https://www.tandfonline.com/doi/pdf/10.1080/10618600.2023.2277297) and [here](https://www.tandfonline.com/doi/pdf/10.1080/00401706.2024.2407314). A vignette for this package is also available and can be viewed by typing `browseVignettes("concordance")` in R (after installation). 

### Example Usage

Traditional active subspaces can be computed using the `C_bass()` function.

```{R, eval=FALSE}
# Load libraries
library(BASS)
library(coactivity)

# Generate data
f <- function(x, t) { 
  10 * sin(pi * t * x[1]) + 20 * (x[2] - 0.5)^2 + 10 * x[3] + 5 * x[4]
}
X <- lhs::randomLHS(500, 5)
y <- apply(X, 1, f, t = 0.5)

# Fit BASS model (scalar response)
mod <- BASS::bass(X, y)

# Estimate C matrix
C <- coactivity::C_bass(mod, mcmc.use=seq(1000, 10000, by=1000))

# Combine (or alternatively, study the samples)
C_post_mean <- apply(simplify2array(C), 1:2, mean)

# Get active subspace
W <- eigen(C_post_mean)$vectors
Lambda <- eigen(C_post_mean)$values
```

For functional response, we can do this three different ways. 

   1. A list of scalar-response BASS models
   2. A functional response BASS model with the `bass()` function.
   3. A functional response BASS model using orthogonal basis decomposition, e.g., via `bassPCA()`.
   
There is generally no reason to use method 1, as methods 2 and 3 are often preferable. Note that method 3 is likely to be much more efficient for functional response, though method 2 can lead to better model fits in some circumstances. 

Moving beyond typical active subspaces, consider also *co-active subspaces* with `Cfg_bass()` or the Zahm (and co-Zahm) matrices with `K_bass()` and `Kfg_bass()`. Finally, to treat the functional variable $t$ as just another input to the model, use `C_aug_bass()` and `Cfg_aug_bass()`. 

## Copyright Notice
&copy; *2023. Triad National Security, LLC. All rights reserved.*

*This program was produced under U.S. Government contract 89233218CNA000001 for Los Alamos
National Laboratory (LANL), which is operated by Triad National Security, LLC for the U.S.
Department of Energy/National Nuclear Security Administration. All rights in the program are
reserved by Triad National Security, LLC, and the U.S. Department of Energy/National Nuclear
Security Administration. The Government is granted for itself and others acting on its behalf a
nonexclusive, paid-up, irrevocable worldwide license in this material to reproduce, prepare
derivative works, distribute copies to the public, perform publicly and display publicly, and to permit
others to do so.*


## References



